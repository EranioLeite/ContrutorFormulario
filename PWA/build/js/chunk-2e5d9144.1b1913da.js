(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e5d9144"],{"25f0":function(t,e,a){"use strict";var o=a("6eeb"),i=a("825a"),s=a("d039"),r=a("ad6d"),n="toString",c=RegExp.prototype,d=c[n],l=s((function(){return"/a/b"!=d.call({source:"a",flags:"b"})})),u=d.name!=n;(l||u)&&o(RegExp.prototype,n,(function(){var t=i(this),e=String(t.source),a=t.flags,o=String(void 0===a&&t instanceof RegExp&&!("flags"in c)?r.call(t):a);return"/"+e+"/"+o}),{unsafe:!0})},5319:function(t,e,a){"use strict";var o=a("d784"),i=a("825a"),s=a("7b0b"),r=a("50c4"),n=a("a691"),c=a("1d80"),d=a("8aa5"),l=a("14c3"),u=Math.max,v=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,h=/\$([$&'`]|\d\d?)/g,m=function(t){return void 0===t?t:String(t)};o("replace",2,(function(t,e,a,o){var g=o.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=o.REPLACE_KEEPS_$0,w=g?"$":"$0";return[function(a,o){var i=c(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,i,o):e.call(String(i),a,o)},function(t,o){if(!g&&b||"string"===typeof o&&-1===o.indexOf(w)){var s=a(e,t,this,o);if(s.done)return s.value}var c=i(t),p=String(this),f="function"===typeof o;f||(o=String(o));var h=c.global;if(h){var y=c.unicode;c.lastIndex=0}var k=[];while(1){var S=l(c,p);if(null===S)break;if(k.push(S),!h)break;var x=String(S[0]);""===x&&(c.lastIndex=d(p,r(c.lastIndex),y))}for(var M="",P=0,N=0;N<k.length;N++){S=k[N];for(var j=String(S[0]),q=u(v(n(S.index),p.length),0),C=[],E=1;E<S.length;E++)C.push(m(S[E]));var $=S.groups;if(f){var D=[j].concat(C,q,p);void 0!==$&&D.push($);var V=String(o.apply(void 0,D))}else V=_(j,p,q,C,$,o);q>=P&&(M+=p.slice(P,q)+V,P=q+j.length)}return M+p.slice(P)}];function _(t,a,o,i,r,n){var c=o+t.length,d=i.length,l=h;return void 0!==r&&(r=s(r),l=f),e.call(n,l,(function(e,s){var n;switch(s.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,o);case"'":return a.slice(c);case"<":n=r[s.slice(1,-1)];break;default:var l=+s;if(0===l)return e;if(l>d){var u=p(l/10);return 0===u?e:u<=d?void 0===i[u-1]?s.charAt(1):i[u-1]+s.charAt(1):e}n=i[l-1]}return void 0===n?"":n}))}}))},cd11:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-content",{staticStyle:{margin:"10px"}},[a("k-loading",{attrs:{title:"Carregando",dialog:t.dialogLoading}}),a("k-dialog",{attrs:{dialog:t.dialogMessage,title:"Mensagem",text:t.textError},on:{fecharDialog:t.fecharDialogMessage}}),a("k-dialog",{attrs:{dialog:t.visualizarProdutoDialog,title:"Visualizar Produto/Serviço",text:t.justificativaProduto},on:{fecharDialog:t.fecharVisualizarProdutoDialog}}),a("v-row",[a("v-col",{attrs:{cols:"9",sm:"10"}},[a("h2",[t._v("Nova Requisição")])]),a("v-spacer"),a("v-col",{attrs:{cols:"1"}},[t.isMobile||t.idSolicitacao?t._e():a("v-icon",{attrs:{"x-large":"",color:"primary"},on:{click:function(e){return t.saveSolicitacao()}}},[t._v("mdi-content-save")]),!t.isMobile&&t.idSolicitacao?a("v-icon",{attrs:{"x-large":"",color:"primary"},on:{click:function(e){return t.updateSolicitacao()}}},[t._v("mdi-pencil")]):t.isMobile&&!t.idSolicitacao?a("v-btn",{staticStyle:{"margin-bottom":"10vh"},attrs:{absolute:"",fab:"",bottom:"",fixed:"",right:"",color:"primary"},on:{click:function(e){return t.saveSolicitacao()}}},[a("v-icon",{attrs:{color:"colorPrimaryText"}},[t._v("mdi-content-save")])],1):t.isMobile&&t.idSolicitacao?a("v-btn",{staticStyle:{"margin-bottom":"10vh"},attrs:{absolute:"",fab:"",bottom:"",fixed:"",right:"",color:"primary"},on:{click:function(e){return t.updateSolicitacao()}}},[a("v-icon",{attrs:{color:"colorPrimaryText"}},[t._v("mdi-pencil")])],1):t._e()],1),a("v-spacer")],1),a("v-row",[a("v-col",{attrs:{cols:"2"}},[a("h3",[t._v("Requisição")])])],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"4"}},[a("v-autocomplete",{attrs:{items:t.itensColaboradores,label:"Colaborador *",autocomplete:"off","item-text":"nome","item-value":"codigo",outlined:"",dense:""},model:{value:t.solicitacao.solicitante,callback:function(e){t.$set(t.solicitacao,"solicitante",e)},expression:"solicitacao.solicitante"}})],1),a("v-col",{attrs:{cols:"12",sm:"2"}},[a("v-autocomplete",{attrs:{items:t.itensFiliais,label:"Filial *",autocomplete:"off","item-text":"nome","item-value":"codigo",outlined:"",dense:""},model:{value:t.solicitacao.filial,callback:function(e){t.$set(t.solicitacao,"filial",e)},expression:"solicitacao.filial"}})],1),a("v-col",{attrs:{cols:"12",sm:"2"}},[a("v-autocomplete",{attrs:{items:t.itensCentroCustos,label:"Departamentos *",autocomplete:"off","item-text":"nome","item-value":"codigo",outlined:"",dense:""},model:{value:t.solicitacao.centroCusto,callback:function(e){t.$set(t.solicitacao,"centroCusto",e)},expression:"solicitacao.centroCusto"}})],1),a("v-col",{attrs:{cols:"12",sm:"2"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-text-field",t._g({attrs:{label:"Necessidade *",dense:"","append-icon":"mdi-calendar",outlined:"",readonly:""},model:{value:t.solicitacao.dataVencimento,callback:function(e){t.$set(t.solicitacao,"dataVencimento",e)},expression:"solicitacao.dataVencimento"}},o))]}}]),model:{value:t.dataVencimentoMenu,callback:function(e){t.dataVencimentoMenu=e},expression:"dataVencimentoMenu"}},[a("v-date-picker",{on:{input:function(e){t.dataVencimentoMenu=!1}},model:{value:t.solicitacao.dataVencimento,callback:function(e){t.$set(t.solicitacao,"dataVencimento",e)},expression:"solicitacao.dataVencimento"}})],1)],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"10"}},[a("v-text-field",{staticStyle:{"margin-top":"-10px"},attrs:{outlined:"",label:"Observação",dense:""},model:{value:t.solicitacao.descricao,callback:function(e){t.$set(t.solicitacao,"descricao",e)},expression:"solicitacao.descricao"}})],1)],1),a("v-divider"),a("v-row",[a("v-col",{attrs:{cols:"5",sm:"10"}},[a("h3",[t._v("Produtos/Serviços")])]),a("v-spacer")],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"5"}},[a("v-autocomplete",{attrs:{items:t.itensProdutos,label:"Produto/Serviço *",autocomplete:"off","item-text":"pesquisa","item-value":"codigo",outlined:"",dense:""},model:{value:t.produto.produto,callback:function(e){t.$set(t.produto,"produto",e)},expression:"produto.produto"}})],1),a("v-col",{attrs:{cols:"12",sm:"3"}},[a("v-text-field",{attrs:{type:"number",outlined:"",label:"Quantidade ( "+(this.produtoSelecionado.um?this.produtoSelecionado.um:"-")+" ) *",dense:""},model:{value:t.produto.quantidade,callback:function(e){t.$set(t.produto,"quantidade",e)},expression:"produto.quantidade"}})],1),a("v-col",{attrs:{cols:"12",sm:"2"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-text-field",t._g({attrs:{label:"Necessidade *",dense:"","append-icon":"mdi-calendar",outlined:"",readonly:""},model:{value:t.produto.dataNecessidade,callback:function(e){t.$set(t.produto,"dataNecessidade",e)},expression:"produto.dataNecessidade"}},o))]}}]),model:{value:t.dataNecessidadeMenu,callback:function(e){t.dataNecessidadeMenu=e},expression:"dataNecessidadeMenu"}},[a("v-date-picker",{on:{input:function(e){t.dataNecessidadeMenu=!1}},model:{value:t.produto.dataNecessidade,callback:function(e){t.$set(t.produto,"dataNecessidade",e)},expression:"produto.dataNecessidade"}})],1)],1)],1),a("v-row",[a("v-col",{attrs:{cols:"12",sm:"10"}},[a("v-text-field",{attrs:{outlined:"",label:"Motivo *",dense:""},model:{value:t.produto.justificativa,callback:function(e){t.$set(t.produto,"justificativa",e)},expression:"produto.justificativa"}})],1),a("v-col",{attrs:{cols:"12",sm:"1"}},[t.isMobile?a("v-row",[a("v-spacer"),a("v-col",{attrs:{cols:"5"}},[a("v-btn",{attrs:{color:"primary"},on:{click:t.add}},[t._v("Adicionar")])],1),a("v-spacer")],1):a("v-btn",{attrs:{color:"primary"},on:{click:t.add}},[t._v("Adicionar")])],1)],1),a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-col",{attrs:{cols:"12"}},[a("k-data-list",{attrs:{headers:t.headers,itens:t.itens},on:{visualizarProduto:t.visualizarProduto,removerProduto:t.removerProduto},scopedSlots:t._u([{key:"quantidade",fn:function(e){var o=e.item;return[a("v-text-field",{staticStyle:{"padding-top":"15px"},attrs:{type:"number",outlined:"",label:"Quantidade ( "+(o.um?o.um:"-")+" ) *",dense:""},model:{value:o.quantidade,callback:function(e){t.$set(o,"quantidade",e)},expression:"item.quantidade"}})]}},{key:"dataNecessidade",fn:function(e){var o=e.item;return[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-text-field",t._g({staticStyle:{"padding-top":"15px"},attrs:{label:"Necessidade *",dense:"","append-icon":"mdi-calendar",outlined:"",readonly:""},model:{value:o.dataNecessidade,callback:function(e){t.$set(o,"dataNecessidade",e)},expression:"item.dataNecessidade"}},i))]}}],null,!0),model:{value:t.dataNecessidadeItemMenu,callback:function(e){t.dataNecessidadeItemMenu=e},expression:"dataNecessidadeItemMenu"}},[a("v-date-picker",{on:{input:function(e){t.dataNecessidadeItemMenu=!1}},model:{value:o.dataNecessidade,callback:function(e){t.$set(o,"dataNecessidade",e)},expression:"item.dataNecessidade"}})],1)]}}])})],1)],1)],1)},i=[],s=(a("4160"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("159b"),a("d4ec")),r=a("bee2"),n=a("99de"),c=a("7e84"),d=a("262e"),l=a("9ab4"),u=a("2b0e"),v=a("b10f"),p=a("823a"),f=a("ecef"),h=a("2fe1");"undefined"!==typeof Reflect&&Reflect.getMetadata;function m(t,e){void 0===e&&(e={});var a=e.deep,o=void 0!==a&&a,i=e.immediate,s=void 0!==i&&i;return Object(h["a"])((function(e,a){"object"!==typeof e.watch&&(e.watch=Object.create(null));var i=e.watch;"object"!==typeof i[t]||Array.isArray(i[t])?"undefined"===typeof i[t]&&(i[t]=[]):i[t]=[i[t]],i[t].push({handler:a,deep:o,immediate:s})}))}var g=a("e736"),b=a("578a"),w=a("40a2"),_=a("38e9"),y=(a("4de4"),a("1276"),a("f175")),k=function(){function t(e){Object(s["a"])(this,t),this._produtos=[{codigo:"",nome:"",dataNecessidade:"",um:"",justificativa:""}],this._lista=[{numero:"",produto:"",descricao:"",quantidade:"",dataNecessidade:"",um:"",justificativa:"",acao:[new w["b"]("","","","","")]}],this._view=e}return Object(r["a"])(t,[{key:"addProdutoLista",value:function(t){if(t.codigo&&t.quantidade)if(parseInt(t.quantidade)<=0)this._view.showMsg("Quantidade inválida.",0);else if(this._lista.filter((function(e){return e.produto===t.codigo})).length>0)this._view.showMsg("Produto inválido.",0);else if(t.dataNecessidade)if(t.justificativa){this._produtos.filter((function(e){return e.codigo===t.codigo}))[0];this._lista.push({numero:(this._lista.length+1).toLocaleString("pt-BR",{minimumIntegerDigits:3}),produto:t.codigo,descricao:t.nome,quantidade:t.quantidade,um:t.um,dataNecessidade:t.dataNecessidade,justificativa:t.justificativa,acao:[new w["b"]("mdi-eye","primary","Visualizar","visualizarProduto","200px"),new w["b"]("mdi-delete","primary","Remover","removerProduto","200px")]}),this._view.showProdutos(this._lista),this._view.limparProduto()}else this._view.showMsg("Motivo inválido.",0);else this._view.showMsg("Data Necessidade inválida.",0);else this._view.showMsg("Preencha o Produto e Quantidade.",0)}},{key:"removeProdutoLista",value:function(t){var e=[{numero:"0",produto:"",descricao:"",quantidade:"",dataNecessidade:"",um:"",justificativa:"",acao:[new w["b"]("","","","","")]}];e=[];var a=1;this._lista.forEach((function(o){o.produto!=t&&(o.numero=a.toLocaleString("pt-BR",{minimumIntegerDigits:3}),e.push(o),a++)})),this._lista=e,this._view.showProdutos(this._lista)}},{key:"getProduto",value:function(t){return t?this._produtos.filter((function(e){return e.codigo===t}))[0]:{quantidade:""}}},{key:"carregarDtos",value:function(){var t=this;this._view.loading(!0),y["a"].get("Solicitacao/GetParametros").then((function(e){if(t._view.loading(!1),e.data.sucesso){var a=e.data.tRetorno;a.produtos.forEach((function(t){t.pesquisa=t.codigo+" - "+t.nome})),t._produtos=a.produtos,t._view.carregarDtos(a.filiais,a.centroCustos,a.produtos,a.fretes,a.colaboradors),t._lista=[]}else t._view.showMsg(e.data.message,0)})).catch((function(e){t._view.loading(!1),t._view.showMsg(e,0)}))}},{key:"validarSolicitacao",value:function(t){return t.solicitante?t.filial?t.centroCusto?t.solicitante?(console.log(t.produtos),t.produtos.length<=0?(this._view.showMsg("Solicite pelo menos um produto.",0),!1):!!t.user||(this._view.showMsg("A propriedade Usuário é obrigatória.",0),!1)):(this._view.showMsg("A propriedade Data Vencimento é obrigatória.",0),!1):(this._view.showMsg("A propriedade Departamento é obrigatória.",0),!1):(this._view.showMsg("A propriedade Filial é obrigatória.",0),!1):(this._view.showMsg("A propriedade Colaborador é obrigatória.",0),!1)}},{key:"salvar",value:function(t){var e=this;this.validarSolicitacao(t)&&(this._view.loading(!0),y["a"].post("Solicitacao",t).then((function(t){e._view.loading(!1),t.data.sucesso?e._view.showMsg(t.data.message,1):e._view.showMsg(t.data.message,0)})).catch((function(t){e._view.loading(!1),e._view.showMsg(t,0)})))}},{key:"update",value:function(t,e){var a=this;this.validarSolicitacao(e)&&(this._view.loading(!0),y["a"].put("Solicitacao/"+t,e).then((function(t){a._view.loading(!1),t.data.sucesso?a._view.showMsg("Salvo com sucesso.",1):a._view.showMsg(t.data.message,0)})).catch((function(t){a._view.loading(!1),a._view.showMsg(t,0)})))}},{key:"getProdutoForEditar",value:function(t){var e=this;this._view.loading(!0),y["a"].get("Solicitacao/ById/"+t).then((function(t){if(e._view.loading(!1),t.data){t.data.dataVencimento=t.data.dataVencimento.split("T")[0],e._lista=[];var a=1;t.data.itens.forEach((function(t){var o={numero:a.toLocaleString("pt-BR",{minimumIntegerDigits:3}),produto:t.codProduto,descricao:e._produtos.filter((function(e){return e.codigo==t.codProduto}))[0].nome,quantidade:t.quantidade,um:e._produtos.filter((function(e){return e.codigo==t.codProduto}))[0].um,dataNecessidade:t.dataNecessidadeFormat,justificativa:t.justificativa,acao:[new w["b"]("mdi-eye","primary","Visualizar","visualizarProduto","200px"),new w["b"]("mdi-delete","primary","Remover","removerProduto","200px")]};e._lista.push(o),a++})),e._view.showProdutoForEditar(t.data,e._lista)}else e._view.showMsg("Não encontrado. ",0)})).catch((function(t){console.log(t),e._view.loading(!1),e._view.showMsg(t,0)}))}}]),t}(),S=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(n["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.dataVencimentoMenu=!1,t.dataNecessidadeMenu=!1,t.dataNecessidadeItemMenu=!1,t.isMobile=!1,t.isSucesso=!1,t.dialogLoading=!1,t.dialogMessage=!1,t.textError="",t.visualizarProdutoDialog=!1,t.justificativaProduto="",t.itensFiliais=[],t.itensCentroCustos=[],t.itensProdutos=[{nome:"",codigo:"",quantidade:""}],t.itensFretes=[],t.itensColaboradores=[],t.produtoSelecionado={quantidade:"",dataNecessidade:"",um:"-",justificativa:""},t.headers=new _["a"]([new w["a"]("Número","numero",!1,!1),new w["a"]("Produto/Serviço","produto",!1,!1),new w["a"]("Descrição","descricao",!1,!1),new w["a"]("Quantidade","quantidade",!1,!1),new w["a"]("Necessidade","dataNecessidade",!1,!1),new w["a"]("Ações","acao",!0,!1)]),t.idSolicitacao="",t.itens=[{numero:"0",produto:"",descricao:"",quantidade:"",um:"-",dataNecessidade:"",justificativa:"",acao:[new w["b"]("","","","","")]}],t.colaborador={},t.solicitacao={solicitante:"",filial:"",centroCusto:"",frete:" N/A",dataVencimento:"",descricao:"",produtos:t.itens,user:0},t.produto={produto:"",quantidade:"",dataNecessidade:"",um:"-",justificativa:""},t}return Object(d["a"])(e,t),Object(r["a"])(e,[{key:"loading",value:function(t){this.dialogLoading=t}},{key:"fecharDialogMessage",value:function(){this.dialogMessage=!1,this.isSucesso&&this.$router.push("/solicitacoes")}},{key:"showMsg",value:function(t,e){this.textError=t,1==e&&(this.isSucesso=!0),this.dialogMessage=!0}},{key:"saveSolicitacao",value:function(){this.solicitacao.produtos=this.itens,this.solicitacao.user=parseInt(b["a"].get("User")),this._controller.salvar(this.solicitacao)}},{key:"updateSolicitacao",value:function(){this.itens.forEach((function(t){t.quantidade=t.quantidade.toString().replace(".",",")})),this.solicitacao.produtos=this.itens,this.solicitacao.user=parseInt(b["a"].get("User")),this._controller.update(this.idSolicitacao,this.solicitacao)}},{key:"removerProduto",value:function(t){this._controller.removeProdutoLista(t.produto)}},{key:"visualizarProduto",value:function(t){this.justificativaProduto="Motivo: "+t.justificativa,this.visualizarProdutoDialog=!0}},{key:"fecharVisualizarProdutoDialog",value:function(){this.visualizarProdutoDialog=!1}},{key:"add",value:function(){this.produtoSelecionado.quantidade=this.produto.quantidade,this.produtoSelecionado.dataNecessidade=this.produto.dataNecessidade,this.produtoSelecionado.justificativa=this.produto.justificativa,this._controller.addProdutoLista(this.produtoSelecionado)}},{key:"showProdutos",value:function(t){this.itens=t}},{key:"carregarDtos",value:function(t,e,a,o,i){this.itensFiliais=t,this.itensCentroCustos=e,this.itensProdutos=a,this.itensFretes=o,this.itensColaboradores=i,this.$route.params.id?(this.idSolicitacao=this.$route.params.id,this._controller.getProdutoForEditar(this.idSolicitacao)):this.colaborador&&(this.solicitacao.solicitante=this.colaborador.codigo,this.solicitacao.filial=this.colaborador.filial,this.solicitacao.centroCusto=this.colaborador.centroCusto)}},{key:"showProdutoForEditar",value:function(t,e){this.solicitacao=t,this.itens=e}},{key:"limparProduto",value:function(){this.produto={produto:"",quantidade:"",justificativa:"",um:"-",dataNecessidade:this.solicitacao.dataVencimento}}},{key:"created",value:function(){this._controller=new k(this),this.colaborador=JSON.parse(b["a"].get("Colaborador")),this._controller.carregarDtos(),this.isMobile=g["a"].isMobile(),this.itens=[]}},{key:"onPropertyChanged",value:function(t,e){this.produtoSelecionado=this._controller.getProduto(this.produto.produto)}},{key:"produtoChange",value:function(t,e){this.produto.dataNecessidade=this.solicitacao.dataVencimento}}]),e}(u["default"]);l["a"]([m("produto.produto")],S.prototype,"onPropertyChanged",null),l["a"]([m("solicitacao.dataVencimento")],S.prototype,"produtoChange",null),S=l["a"]([Object(h["b"])({components:{KLoading:v["a"],KDialog:p["a"],KDataList:f["a"]}})],S);var x=S,M=x,P=a("2877"),N=Object(P["a"])(M,o,i,!1,null,null,null);e["default"]=N.exports}}]);
//# sourceMappingURL=chunk-2e5d9144.1b1913da.js.map